# Docker Profile - Disable MongoDB, use only PostgreSQL

# Disable MongoDB auto-configuration completely
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,org.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration

# Disable MongoDB auditing
spring.data.mongodb.enabled=false

# Neon PostgreSQL Configuration (Primary Database)
# Fixed URL encoding for database name with special characters
spring.datasource.url=jdbc:postgresql://ep-calm-wave-ad7wnkd8-pooler.c-2.us-east-1.aws.neon.tech/meow's%20Org?sslmode=require
spring.datasource.username=neondb_owner
spring.datasource.password=npg_BzJ0klf6NIGj
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA Configuration for Neon PostgreSQL - Simplified for Docker
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Disable schema validation completely
spring.jpa.properties.hibernate.hbm2ddl.auto=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.drop_source=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.create_source=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.drop_action=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.create_action=none

# Disable validation
spring.jpa.properties.hibernate.validator.apply_to_ddl=false
spring.jpa.properties.hibernate.validator.autoregister_listeners=false

# Disable schema generation completely
spring.jpa.properties.hibernate.hbm2ddl.auto=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.drop_source=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.create_source=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.drop_action=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.create_action=none

# Disable schema validation
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.scripts.action=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.scripts.create_target=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.scripts.drop_target=none

# Connection pool configuration for Docker
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# File Upload Configuration
spring.servlet.multipart.max-file-size=20MB
spring.servlet.multipart.max-request-size=20MB
spring.servlet.multipart.enabled=true

# Disable open-in-view to prevent transaction issues
spring.jpa.open-in-view=false

# Server Configuration
server.port=8101
server.servlet.context-path=/api/v1

# Logging
logging.level.com.meowcdd=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
# Increase log length to prevent truncation
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.charset.console=UTF-8

# Jackson Configuration
spring.jackson.default-property-inclusion=non_null
spring.jackson.serialization.write-dates-as-timestamps=false
# Ensure JSON is not truncated
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false
# Increase max string length for logging
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
